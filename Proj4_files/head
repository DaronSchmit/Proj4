YUI().use('node','cookie',function(Y){Y.namespace("Media");var mediaList={},wasMedia={},win=Y.config.win,controller=new Y.Event.Target(),UA=YUI.Env.UA,div,style,nativeListenerSupport=!!win.matchMedia;if(!nativeListenerSupport)Y.on("windowresize",function(){var query,medium,isMatch,wasMatch;for(query in mediaList)if(mediaList.hasOwnProperty(query)){medium=mediaList[query];wasMatch=wasMedia[query];isMatch=Y.Media.matches(query);if(isMatch!==wasMatch)controller.fire(query,{media:query,matches:isMatch})}});Y.Media.matches=function(query){var result=false;if(win.matchMedia){result=win.matchMedia(query).matches}else{if(!div){div=document.createElement("div");div.id="yui-m-1";div.style.cssText="position:absolute;top:-1000px";document.body.insertBefore(div,document.body.firstChild)};div.innerHTML="_<style media=\""+query+"\"> #yui-m-1 { width: 1px; }</style>";div.removeChild(div.firstChild);result=div.offsetWidth==1};wasMedia[query]=result;return result};Y.Media.on=function(query,listener,context){if(nativeListenerSupport&&!mediaList[query]){if(YUI.Env.UA.webkit){if(!style){style=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(style)};style.appendChild(document.createTextNode("@media "+query+" { .-yui-m {} }"))};mediaList[query]=win.matchMedia(query);mediaList[query].addListener(function(mql){controller.fire(query,{media:query,matches:mql.matches})})};if(!mediaList[query])mediaList[query]=1;return controller.on(query,listener,context)};Y.on('domready',function(){var break_point=1024,page_content=Y.one('#page-content'),region_main=Y.one('#region-main'),side_pre=Y.one('#block-region-side-pre'),side_post=Y.one('#block-region-side-post'),left_content=Y.one('.umn-clean-left-content'),right_blocks=Y.all('#block-region-side-post div.block');if(side_post!=null){var side_post_display=side_post.getStyle('display'),switch_to_2_column=function(){region_main.appendTo(page_content);side_pre.appendTo(page_content);right_blocks.each(function(node){node.appendTo(side_pre)});side_post.setStyle('display','none')},switch_to_3_column=function(){region_main.appendTo(left_content);side_pre.appendTo(left_content);right_blocks.each(function(node){node.appendTo(side_post)});side_post.setStyle('display',side_post_display)};if(Y.Media.matches('screen and (max-width:'+break_point+'px)'))switch_to_2_column();Y.Media.on('screen and (max-width:'+break_point+'px)',function(result){if(result.matches)switch_to_2_column()});Y.Media.on('screen and (min-width:'+(break_point+1)+'px)',function(result){if(result.matches)switch_to_3_column()})};var user_image_button=Y.one('#user-image-button');if(user_image_button){Y.one('#user-image-button').on('click',function(e){Y.one('#user-panel').toggleClass('active');e.stopPropagation()});Y.one('body').on('click',function(e){Y.one('#user-panel').removeClass('active')})};var region_main=Y.one('#region-main');if(region_main){var page_navbar=Y.one('#page-navbar'),bread_crumb=Y.one('#page-navbar .breadcrumb-button'),left_column=Y.one('#block-region-side-pre'),right_column=Y.one('#block-region-side-post'),header=Y.one('header'),span9=Y.one('#page-content .span9'),span8=Y.one('#page-content .span8'),is_content_max=false;if(left_column||right_column){var max_button=Y.Node.create('<div id="umn-clean-max-content-btn"></div>');Y.on('domready',function(){if(max_button.hasClass('max')){max_button.setAttribute('title',M.util.get_string('maxcontent_restore','theme_umn_clean'))}else max_button.setAttribute('title',M.util.get_string('maxcontent_max','theme_umn_clean'))});if(page_navbar&&bread_crumb&&page_navbar.getStyle('display')!='none'){bread_crumb.prepend(max_button)}else region_main.append(max_button);function maximize_content(){Y.Array.each([left_column,right_column,header],function(el){if(el!=null)el.addClass('hidden')});Y.Array.each([region_main,span8,span9],function(el){if(el!=null)el.addClass('max')});max_button.addClass('max').setAttribute('title',M.util.get_string('maxcontent_restore','theme_umn_clean'));is_content_max=true};if(Y.Cookie.get('content-maximized')=='1')maximize_content();max_button.on('click',function(e){if(!is_content_max){maximize_content();if(e.ctrlKey||e.shiftKey)Y.Cookie.set('content-maximized','1',{path:'/'})}else{Y.Array.each([left_column,right_column,header],function(el){if(el!=null)el.removeClass('hidden')});Y.Array.each([region_main,span8,span9],function(el){if(el!=null)el.removeClass('max')});max_button.removeClass('max').setAttribute('title',M.util.get_string('maxcontent_max','theme_umn_clean'));is_content_max=false;Y.Cookie.remove('content-maximized',{path:'/'})}})}}})})